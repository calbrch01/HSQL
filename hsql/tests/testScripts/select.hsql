--Select out snowy days
import common;

--weather = select * from common.WeatherDataSet;
weather = select * from '~hsql::testfiles::weatherdata.csv' layout common.WeatherDataLayout;


--weatherGrp = select Date,SnowDepth from weather group by SnowDepth;

--weatherSnowy = select Date,SnowDepth,NewSnow from weather where SnowDepth>0 and NewSnow>0;

weatherSnowyTotal = select Sum(SnowDepth) from weather where SnowDepth>0;
weatherSnowyNum = Select COUNT(SnowDepth) from weather where SnowDepth>0;

ran = select sum(SnowDepth) from (select SnowDepth from weather);



weatherSnowDepth = select Date,SnowDepth from weather;
weatherNewSnow = select Date,NewSnow from weather;

weatherjoin = select * from weatherSnowDepth where newSnow>0 join weatherNewSnow on weatherSnowDepth.Date = weatherNewSnow.Date;

output weatherGrp title 'group_output' expire 3;

OUTPUT weatherSnowy expire 3;
OUTPUT weatherSnowyTotal expire 1;
OUTPUT weatherSnowyNum;

plot from weatherSnowyTotal title 'SnowyDays' type bar;

output weatherjoin;